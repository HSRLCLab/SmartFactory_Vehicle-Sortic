<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SmartVehicle-Sortic: SmartFactory_Vehicle-Sortic</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SmartVehicle-Sortic
   </div>
   <div id="projectbrief">SmartFactory</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__v_1__git__smart_factory__vehicle-_sortic__r_e_a_d_m_e.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">SmartFactory_Vehicle-Sortic </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <a href="https://github.com/LMazzole/SmartFactory_Vehicle-Sortic">SmartFactory_Vehicle-Sortic</a> is an implementation from the SmartFactory Project for Sortic.</p>
<p>It's a Smart-Vehicle which can navigate on a known game-table and communicates this information wirelessly to its environment using the <a href="https://github.com/LMazzole/SmartFactory_MQTTCommunication">SmartFactory_MQTTCommunication</a> and the <a href="https://github.com/LMazzole/SmartFactory_Vehicle-Basis">SmartFactory_Vehicle-Basis</a> -component.</p>
<p>Multiple nested Finite State Machines (FSM) based on the pattern of the <a href="https://github.com/LMazzole/ArdFSM">ArdFSM</a> are used to control the processes.</p>
<h2>Table of Content</h2>
<h2>The SmartFactory Project - Sortic</h2>
<p>The implementation of the SmartFactory project for Sortic looks like this:</p>
<img src="./docs/images/RepoOverview.png" height="300" alt="" class="inline"/>
<p>The associated Repositorys are:</p>
<p><a href="https://github.com/LMazzole/SmartFactory-Sortic">SmartFactory-Sortic</a></p>
<p><a href="https://github.com/LMazzole/SmartFactory_Box-Sortic">SmartFactory_Box-Sortic</a></p>
<p><a href="https://github.com/LMazzole/SmartFactory_Vehicle-Sortic">SmartFactory_Vehicle-Sortic</a></p>
<p><a href="https://github.com/LMazzole/SmartFactory_Vehicle-Basis">SmartFactory_Vehicle-Basis</a></p>
<p><a href="https://github.com/LMazzole/SmartFactory_MQTTCommunication">SmartFactory_MQTTCommunication</a></p>
<h2>Tools and Technologies</h2>
<p>The source-code is written in C++. To achieve this project, the following listed tools and technologies were used.</p>
<h3>Doxygen</h3>
<p>Doxygen is used for the documentation of the source-code.</p>
<p>An intorduction to <em>Doxygen</em> and how to install it can be found in the <a href="https://github.com/LMazzole/ArdFSM#documentation-with-doxygen">ArdFSM-Repo</a>.</p>
<h3>VSCode PlatformIO</h3>
<p>The used IDE is <a href="https://code.visualstudio.com/">VSCode</a> with the <a href="https://platformio.org/platformio-ide">PlatformIO</a>-Extension.</p>
<h3>MQTT</h3>
<p>For a description of the MQTT-Technologie take a look at the <a href="https://github.com/LMazzole/SmartFactory_MQTTCommunication#mqtt">MQTTCommunication-ReadMe</a>.</p>
<h1>Documentation</h1>
<h2>Hardware</h2>
<p>For a description of the used Hardware take a look at the <a href="https://github.com/LMazzole/SmartFactory_Vehicle-Basis">Vehicle-Basis-ReadMe</a>.</p>
<h2>Gametable</h2>
<p>The Gametable consists of black lines on a white (light) background. It is composed of different sectors:</p>
<ul>
<li>Handover (Sortic/Transfer)</li>
<li>Gateway (Sortic/Transfer)</li>
<li>Waiting area</li>
<li>Transit</li>
<li>Parking</li>
</ul>
<p>These sectors are also separate states and can easily be customized in <a href="https://lmazzole.github.io/SmartFactory_Vehicle-Sortic/class_navigation_ctrl.html">NavigationCtrl</a>. <img src="./lib/Navigation/Gametable.png" height="500" alt="" class="inline"/>
 <img src="./docs/images/GametableDimension.png" height="500" alt="" class="inline"/>
<h2>Software</h2>
<p>All functions and files are documented on the <a href="https://lmazzole.github.io/SmartFactory_Vehicle-Sortic/">GitHub-Page with Doxygen</a>.</p>
<p>The documentation includes also the <a href="https://github.com/LMazzole/SmartFactory_MQTTCommunication">MQTTCommunication</a> and the <a href="https://github.com/LMazzole/SmartFactory_Vehicle-Basis">SmartFactory_Vehicle-Basis</a>-Files.</p>
<p>It's important to mention that all functions are non blocking and as short as possible so no other process starves. This way a degree of parallelism can be achieved.</p>
<h3>Dependency Graph</h3>
<p><a href="https://lmazzole.github.io/SmartFactory_Vehicle-Sortic/main_8cpp.html"><img src="./docs/main_8cpp__incl.png" alt="" class="inline"/>
</a></p>
<p>Extern Libraries:</p>
<ul>
<li><a href="https://github.com/LMazzole/SmartFactory_MQTTCommunication">SmartFactory_MQTTCommunication</a></li>
<li><a href="https://github.com/LMazzole/SmartFactory_Vehicle-Basis">SmartFactory_Vehicle-Basis</a></li>
</ul>
<h3>Collaboration Diagram</h3>
<p><a href="https://lmazzole.github.io/SmartFactory_Vehicle-Sortic/class_vehicle_ctrl.html"><img src="./docs/class_vehicle_ctrl__coll__graph.png" alt="" class="inline"/>
</a></p>
<h3>Important Functions and Files</h3>
<h4><a class="el" href="_configuration_8h.html" title="File that contains the configuratioindetails of the different modules.">Configuration.h</a></h4>
<p>In <a href="https://lmazzole.github.io/SmartFactory_Vehicle-Sortic/_configuration_8h.html">Configuration.h</a> are all important settings for the Vehicle defined:</p>
<ul>
<li>Time between the MQTT Publishs (TIME_BETWEEN_PUBLISH)</li>
<li>How long the SmartVehicle for Box-Acknolegemnt waits (TIMEOUT_VACKS)</li>
<li>How many lines there are (SORTIC_MAX_LINE)</li>
<li>The Hostname number (DEFAUL_HOSTNAME_NUMBER)</li>
<li>The Hostname "SV"+ Hostnamenumber (DEFAULT_HOSTNAME)</li>
</ul>
<h3>Communication</h3>
<p>The SmartVehicle communicates via the <a href="https://github.com/LMazzole/SmartFactory_MQTTCommunication">SmartFactory_MQTTCommunication</a> to an MQTT-Broker, who distributes the messages. The communication works by subscribing to various topics. The subscribed Topics change depending on action and position of the Vehicle. The Topic-Tree looks like this:</p>
<img src="./docs/images/MQTTTopics.png" height="600" alt="" class="inline"/>
<p>The Vehicle is constantly subscribed to the topics: <em>error, Vehicle/error, Vehicle/vehicle.id/error</em> and also always publishes its status to <em>Vehicle/vehicle.id/status</em>.</p>
<p>More information about the communication process and the complete procedure is documented in <a href="https://github.com/LMazzole/SmartFactory-Sortic#smartfactory-sortic">SmartFactroy-Sortic-ReadMe</a>.</p>
<h4>Handshake with Box</h4>
<p>For an handshake with a box the topic <em>Vehicle/vehicle.id/handshake</em> is used. The Confirmation of the new position is send from the vehicle to the <em>Box/box.id/position</em>.</p>
<object type="image/svg+xml" data="./docs/images/Handshake-detailed.svg" height="650"></object>
/>
<h4>Transfer and Vehicle</h4>
<p>Before the vehicle can bring the box to its new destination, it has to find out where its load is needed and whether that space is available. For this it subscribes to the Topic Transfer/Handover and evaluates the received messages.</p>
<object type="image/svg+xml" data="./docs/images/TransferToSV-detailed.svg" height="550"></object>
/>
<h2>FAQ's</h2>
<h4>I'd like to use this code in my project. What do I need to know?</h4>
<blockquote class="doxtable">
<p>This Repository is specifically for Sortic. You can still use it, if you stick to the following rules:</p>
<ul>
<li>Use the same Handshake and Communication-Sequence for your carrier as documented in <a href="https://github.com/LMazzole/SmartFactory-Sortic">SmartFactory-Sortic</a> and <a href="#communication">Communication</a>. </li>
</ul>
</blockquote>
<h3>ToDo's</h3>
<h4>Software</h4>
<p>All open ToDo's can be found in the Documentation on the <a href="https://lmazzole.github.io/SmartFactory_Box-Sortic/todo.html">GitHub-Page</a></p>
<h2>Contributors</h2>
<ul>
<li><a href="https://github.com/LMazzole">Luca Mazzoleni</a></li>
</ul>
<h2>Changelog</h2>
<p>V 1.0 - Release BA FS19 - <a href="https://github.com/LMazzole">Luca Mazzoleni</a></p>
<h2>License</h2>
<p>[TODO] </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
